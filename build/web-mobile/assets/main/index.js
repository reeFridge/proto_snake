System.register("chunks:///_virtual/FollowCamera.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,i,r,a,o,n,l,h,c,s,d,u,f,w,S,p,g,v,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inherits,r=e.createSuper,a=e.classCallCheck,o=e.initializerDefineProperty,n=e.assertThisInitialized,l=e.defineProperty,h=e.createClass},function(e){c=e.cclegacy,s=e._decorator,d=e.Node,u=e.Rect,f=e.Size,w=e.game,S=e.Camera,p=e.screen,g=e.Vec3,v=e.clamp,y=e.Component}],execute:function(){var z,R,m,C,P,b,x;c._RF.push({},"0d499IHvM5CDpi4SAMSfO5D","FollowCamera",void 0);var k=s.ccclass,F=s.property;e("FollowCamera",(z=k("FollowCamera"),R=F(d),m=F(u),z((b=t((P=function(e){i(c,e);var t=r(c);function c(){var e;a(this,c);for(var i=arguments.length,r=new Array(i),h=0;h<i;h++)r[h]=arguments[h];return e=t.call.apply(t,[this].concat(r)),o(n(e),"target",b,n(e)),o(n(e),"worldRect",x,n(e)),l(n(e),"halfScreenSize",new f),e}return h(c,[{key:"onLoad",value:function(){w.canvas;var e=this.node.getComponent(S),t=p.devicePixelRatio;w.canvas&&(e.orthoHeight=w.canvas.height/t/2)}},{key:"start",value:function(){var e=p.devicePixelRatio;this.halfScreenSize=p.windowSize,this.halfScreenSize.width=this.halfScreenSize.width/e/2,this.halfScreenSize.height=this.halfScreenSize.height/e/2,this.node.getComponent(S).orthoHeight=this.halfScreenSize.height}},{key:"lateUpdate",value:function(e){var t=this.target.getWorldPosition(),i=this.node.getWorldPosition().z,r=new u(this.worldRect.x+this.halfScreenSize.width,this.worldRect.y+this.halfScreenSize.height,this.worldRect.x+this.worldRect.width-this.halfScreenSize.width,this.worldRect.y+this.worldRect.height-this.halfScreenSize.height);this.node.setWorldPosition(new g(v(t.x,r.x,r.width),v(t.y,r.y,r.height),i))}},{key:"setWorldRect",value:function(e){this.worldRect=e}}]),c}(y)).prototype,"target",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=t(P.prototype,"worldRect",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new u(0,0,100,100)}}),C=P))||C));c._RF.pop()}}}));

System.register("chunks:///_virtual/common.ts",["cc","./Tail.ts","./Controller.ts"],(function(t){"use strict";var e,n,o,i,r,c;return{setters:[function(t){e=t.cclegacy,n=t.Vec2,o=t.Rect,i=t.Vec3},function(t){r=t.Tail},function(t){c=t.Controller}],execute:function(){t({colliderToRect:function(t){var e=new o,n=t.node.getWorldPosition(new i),r=n.x,c=n.y;return e.x=r+t.offset.x-.5*t.size.width,e.y=c+t.offset.y-.5*t.size.height,e.width=t.size.width,e.height=t.size.height,e},getNodeCurrentDirection:function(t){var e=t.getComponent(r)||t.getComponent(c);return e?e.getCurrentDirection():null},getNodeDestination:function(t){var e=t.getComponent(r)||t.getComponent(c);return e?e.getDestination():null},getNodeStartPosition:function(t){var e=t.getComponent(r)||t.getComponent(c);return e?e.getStartPosition():null}}),e._RF.push({},"17096Z6m0ZCuIR4eZhg9HFh","common",void 0);t("UP",new n(0,1)),t("RIGHT",new n(1,0)),t("DOWN",new n(0,-1)),t("LEFT",new n(-1,0)),t("EPSILON",.001),t("CELL_SIZE",64);e._RF.pop()}}}));

System.register("chunks:///_virtual/Grid.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./common.ts"],(function(r){"use strict";var e,i,o,t,n,a,c,l,s,u,p,d,f,h;return{setters:[function(r){e=r.applyDecoratedDescriptor,i=r.inherits,o=r.createSuper,t=r.classCallCheck,n=r.initializerDefineProperty,a=r.assertThisInitialized,c=r.defineProperty,l=r.createClass},function(r){s=r.cclegacy,u=r._decorator,p=r.Graphics,d=r.Color,f=r.Component},function(r){h=r.CELL_SIZE}],execute:function(){var y,C,v,g,m,b,G,E;s._RF.push({},"26b13PDaGREb6BEmsfKf6LK","Grid",void 0);var L=u.ccclass,_=u.property,w=u.requireComponent,k=u.executeInEditMode;r("Grid",(y=L("Grid"),C=w(p),v=_(d),g=_(d),y(m=C(m=k((G=e((b=function(r){i(s,r);var e=o(s);function s(){var r;t(this,s);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=e.call.apply(e,[this].concat(o)),n(a(r),"primaryColor",G,a(r)),n(a(r),"secondaryColor",E,a(r)),c(a(r),"graphics",void 0),r}return l(s,[{key:"onLoad",value:function(){this.drawGrid(10,10)}},{key:"drawGrid",value:function(r,e){this.graphics=this.node.getComponent(p),this.graphics.clear();for(var i=0;i<r;++i)for(var o=0;o<e;++o)this.graphics.fillColor=(i+o+1)%2?this.primaryColor:this.secondaryColor,this.graphics.fillRect(i*h,o*h,h,h)}}]),s}(f)).prototype,"primaryColor",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return d.WHITE.clone()}}),E=e(b.prototype,"secondaryColor",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return d.BLACK.clone()}}),m=b))||m)||m)||m));s._RF.pop()}}}));

System.register("chunks:///_virtual/Type.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,r,n,i,c,a,o,p,u,l;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inherits,n=e.createSuper,i=e.classCallCheck,c=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){o=e.cclegacy,p=e._decorator,u=e.Enum,l=e.Component}],execute:function(){var s,y,f,T,h;e("ObjectType",void 0),o._RF.push({},"2701ahDIAtJf4pJ2VCb5cAh","Type",void 0);var v,b=p.ccclass,O=(p.property,p.type);!function(e){e[e.NONE=0]="NONE",e[e.OBSTACLE=1]="OBSTACLE",e[e.FRUIT=2]="FRUIT"}(v||(v=e("ObjectType",{}))),u(v);e("Type",(s=b("Type"),y=O(v),s((h=t((T=function(e){r(o,e);var t=n(o);function o(){var e;i(this,o);for(var r=arguments.length,n=new Array(r),p=0;p<r;p++)n[p]=arguments[p];return e=t.call.apply(t,[this].concat(n)),c(a(e),"type",h,a(e)),e}return o}(l)).prototype,"type",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return v.NONE}}),f=T))||f));o._RF.pop()}}}));

System.register("chunks:///_virtual/Tail.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Controller.ts","./common.ts"],(function(t){"use strict";var e,i,n,o,r,a,s,l,c,u,h,d,p,y,f,v,P;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inherits,n=t.createSuper,o=t.classCallCheck,r=t.initializerDefineProperty,a=t.assertThisInitialized,s=t.defineProperty,l=t.createClass},function(t){c=t.cclegacy,u=t._decorator,h=t.Node,d=t.Vec2,p=t.Vec3,y=t.Component},function(t){f=t.Controller},function(t){v=t.getNodeStartPosition,P=t.CELL_SIZE}],execute:function(){var g,w,k,C,b,m,x;c._RF.push({},"39a0a/h+qxDHYg6tAc3A5DE","Tail",void 0);var D=u.ccclass,S=u.property;t("Tail",(g=D("Tail"),w=S(h),k=S(h),g((m=e((b=function(t){i(c,t);var e=n(c);function c(){var t;o(this,c);for(var i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return t=e.call.apply(e,[this].concat(n)),r(a(t),"parentPart",m,a(t)),r(a(t),"head",x,a(t)),s(a(t),"destination",new d(0,0)),s(a(t),"startPosition",new d(0,0)),t}return l(c,[{key:"getDestination",value:function(){return new d(this.destination)}},{key:"getStartPosition",value:function(){return new d(this.startPosition)}},{key:"getCurrentDirection",value:function(){return d.subtract(new d,this.destination,this.node.getWorldPosition(new p)).normalize()}},{key:"initRoute",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.startPosition.x=t.x,this.startPosition.y=t.y,this.destination.x=e.x,this.destination.y=e.y;var n=d.lerp(new d,t,e,i);this.node.setWorldPosition(new p(n.x,n.y,0))}},{key:"updatePosition",value:function(t){var e=new d(0,0);d.lerp(e,this.startPosition,this.destination,t),this.node.setWorldPosition(new p(e.x,e.y,0)),this.checkHeadCollision(e)}},{key:"finishRoute",value:function(){this.startPosition=new d(this.destination);var t=v(this.parentPart);t&&(this.destination=t)}},{key:"checkHeadCollision",value:function(t){d.squaredDistance(this.head.getWorldPosition(new p),t)<P*P/4&&this.head.getComponent(f).setStopped(!0)}}]),c}(y)).prototype,"parentPart",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=e(b.prototype,"head",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=b))||C));c._RF.pop()}}}));

System.register("chunks:///_virtual/Obstacle.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Type.ts"],(function(e){"use strict";var t,n,c,r,o,s,a,u,i,l;return{setters:[function(e){t=e.inherits,n=e.createSuper,c=e.createClass,r=e.classCallCheck},function(e){o=e.cclegacy,s=e._decorator,a=e.BoxCollider2D,u=e.Component},function(e){i=e.Type,l=e.ObjectType}],execute:function(){var p;o._RF.push({},"3bfd4WI9SBLorJVYVUanT9l","Obstacle",void 0);var f=s.ccclass,y=(s.property,s.requireComponent),d=s.executeInEditMode;e("Obstacle",f("Obstacle")(p=y(i)(p=y(a)(p=d(p=function(e){t(s,e);var o=n(s);function s(){return r(this,s),o.apply(this,arguments)}return c(s,[{key:"start",value:function(){this.node.getComponent(i).type=l.OBSTACLE}}]),s}(u))||p)||p)||p)||p);o._RF.pop()}}}));

System.register("chunks:///_virtual/MapGenerator.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./FollowCamera.ts","./Controller.ts","./common.ts","./Grid.ts"],(function(e){"use strict";var t,i,n,r,a,o,s,l,c,h,u,d,p,f,w,b,g,v,m,y,R,C,O,P,k,z,S,E,A,T,x;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inherits,n=e.createSuper,r=e.classCallCheck,a=e.initializerDefineProperty,o=e.assertThisInitialized,s=e.defineProperty,l=e.createClass,c=e.createForOfIteratorHelper},function(e){h=e.cclegacy,u=e._decorator,d=e.Prefab,p=e.Node,f=e.EventTarget,w=e.instantiate,b=e.Vec3,g=e.Vec2,v=e.randomRangeInt,m=e.Size,y=e.UITransform,R=e.BoxCollider2D,C=e.screen,O=e.Rect,P=e.Intersection2D,k=e.Component},function(e){z=e.FollowCamera},function(e){S=e.Controller,E=e.ControllerEvent},function(e){A=e.CELL_SIZE,T=e.colliderToRect},function(e){x=e.Grid}],execute:function(){var F,D,G,L,M,_,I,U,q,N,B,W,H,K,Q,V,j,Z;e("MapGeneratorEvent",void 0),h._RF.push({},"55011DcLixC/6krL/gekULL","MapGenerator",void 0);var J,X=u.ccclass,Y=u.property,$=u.integer;!function(e){e.ROCKS_UPDATED="rocks-updated"}(J||(J=e("MapGeneratorEvent",{})));e("MapGenerator",(F=X("MapGenerator"),D=Y(d),G=Y(d),L=Y(p),M=Y(p),_=Y(p),F((q=t((U=function(e){i(h,e);var t=n(h);function h(){var e;r(this,h);for(var i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return e=t.call.apply(t,[this].concat(n)),a(o(e),"width",q,o(e)),a(o(e),"height",N,o(e)),a(o(e),"obstaclePrefab",B,o(e)),a(o(e),"obstaclesOnStart",W,o(e)),a(o(e),"obstacleAreaPercent",H,o(e)),a(o(e),"fruitPrefab",K,o(e)),a(o(e),"fruitsOnStart",Q,o(e)),a(o(e),"head",V,o(e)),a(o(e),"grid",j,o(e)),a(o(e),"cameraNode",Z,o(e)),s(o(e),"rocksCount",0),s(o(e),"eventTarget",new f),e}return l(h,[{key:"spawnFruit",value:function(e){var t=w(this.fruitPrefab);t.parent=this.node,t.setPosition(new b(e.x,e.y,0))}},{key:"spawnFruitAtRandomPosition",value:function(){for(var e=this.generateRandomCell();this.isCellOccupied(e);)e=this.generateRandomCell();this.spawnFruit(new g(e.x*A,e.y*A))}},{key:"generateRandomCell",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new g(v(e,this.width-e),v(e,this.height-e))}},{key:"generateRandomSize",value:function(e){for(var t=[],i=1;i<=e;++i)e%i==0&&t.push(i);if(!t.length)return null;var n=t[v(0,t.length)];return new m(n,e/n)}},{key:"spawnObstacle",value:function(e,t,i){var n=w(this.obstaclePrefab),r=n.getComponent(y),a=n.getComponent(R),o=new m(e*A,t*A);r.setContentSize(o),a.size=o,n.parent=this.node,n.setPosition(new b(i.x*A+e*A/2-A/2,i.y*A+t*A/2-A/2,0))}},{key:"spawnRandomObstacle",value:function(e){for(var t,i,n,r=this,a=this.width*this.height,o=Math.floor(a*e),s=new m(1,1),l=this.generateRandomSize(o)||s,c=this.generateRandomCell(1);t=void 0,i=void 0,n=void 0,t=l.width+2,i=l.height+2,n=g.subtract(new g,c,new g(1,1)),r.isAreaOccupied(t,i,n);)l=this.generateRandomSize(o)||s,c=this.generateRandomCell(1);this.spawnObstacle(l.width,l.height,c),this.rocksCount++,this.eventTarget.emit(J.ROCKS_UPDATED,this.rocksCount)}},{key:"spawnEdges",value:function(){this.spawnObstacle(this.width,1,new g(0,-1)),this.spawnObstacle(this.width,1,new g(0,this.height)),this.spawnObstacle(1,this.height+2,new g(-1,-1)),this.spawnObstacle(1,this.height+2,new g(this.width,-1))}},{key:"start",value:function(){var e=C.devicePixelRatio,t=C.windowSize,i=new m(Math.floor(t.width/e/A),Math.floor(t.height/e/A));this.width=2*i.width,this.height=2*i.height,console.info("Game field size: ".concat(this.width,"x").concat(this.height)),this.grid.getComponent(x).drawGrid(this.width,this.height);var n=this.head.getComponent(S);n.eventTarget.on(E.FRUIT_REQUEST,this.onFruitRequest,this),n.eventTarget.on(E.OBSTACLE_REQUEST,this.onObstacleRequest,this);var r=this.node.getWorldPosition(new b),a=new O(r.x-A-A/2,r.y-A-A/2,(this.width+2)*A,(this.height+2)*A);this.cameraNode.getComponent(z).setWorldRect(a),this.spawnEdges();for(var o=0;o<this.fruitsOnStart;++o)this.spawnFruitAtRandomPosition();for(var s=0;s<this.obstaclesOnStart;++s)this.spawnRandomObstacle(this.obstacleAreaPercent/100)}},{key:"toLocalRect",value:function(e){var t=this.node.getWorldPosition(new b),i=g.subtract(new g,new g(e.x,e.y),t);return e.x=i.x,e.y=i.y,e}},{key:"isAreaOccupied",value:function(e,t,i){var n,r=c(this.node.children);try{for(r.s();!(n=r.n()).done;){var a=n.value.getComponent(R),o=new O(i.x*A-A/4,i.y*A-A/4,A/2*e+A/2*(e-1),A/2*t+A/2*(t-1));if(a&&P.rectRect(o,this.toLocalRect(T(a))))return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isCellOccupied",value:function(e){return this.isAreaOccupied(1,1,e)}},{key:"onFruitRequest",value:function(){this.spawnFruitAtRandomPosition()}},{key:"onObstacleRequest",value:function(){this.spawnRandomObstacle(this.obstacleAreaPercent/100)}}]),h}(k)).prototype,"width",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),N=t(U.prototype,"height",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),B=t(U.prototype,"obstaclePrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=t(U.prototype,"obstaclesOnStart",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),H=t(U.prototype,"obstacleAreaPercent",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),K=t(U.prototype,"fruitPrefab",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=t(U.prototype,"fruitsOnStart",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),V=t(U.prototype,"head",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=t(U.prototype,"grid",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=t(U.prototype,"cameraNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=U))||I));h._RF.pop()}}}));

System.register("chunks:///_virtual/Fruit.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Type.ts"],(function(e){"use strict";var t,r,i,n,o,c,a,u,p,s,l,y,f,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inherits,i=e.createSuper,n=e.classCallCheck,o=e.initializerDefineProperty,c=e.assertThisInitialized,a=e.createClass},function(e){u=e.cclegacy,p=e._decorator,s=e.BoxCollider2D,l=e.CCInteger,y=e.Component},function(e){f=e.Type,d=e.ObjectType}],execute:function(){var h,v,C,b,g,m,F,T,_;u._RF.push({},"941f0wTi/dJ/rcAYmEYBty7","Fruit",void 0);var w=p.ccclass,z=(p.property,p.requireComponent),D=p.executeInEditMode,I=p.type;e("Fruit",(h=w("Fruit"),v=z(f),C=z(s),b=I(l),g=I(l),h(m=v(m=C(m=D((T=t((F=function(e){r(u,e);var t=i(u);function u(){var e;n(this,u);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),o(c(e),"points",T,c(e)),o(c(e),"speedUp",_,c(e)),e}return a(u,[{key:"start",value:function(){this.node.getComponent(f).type=d.FRUIT}}]),u}(y)).prototype,"points",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),_=t(F.prototype,"speedUp",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),m=F))||m)||m)||m)||m));u._RF.pop()}}}));

System.register("chunks:///_virtual/Trail.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,r,i,n,a,s,o,c,l,u,h,p;return{setters:[function(e){t=e.inherits,r=e.createSuper,i=e.classCallCheck,n=e.defineProperty,a=e.assertThisInitialized,s=e.createClass},function(e){o=e.cclegacy,c=e._decorator,l=e.Graphics,u=e.Vec3,h=e.Vec2,p=e.Component}],execute:function(){var g;o._RF.push({},"9c84ckUhQ1EMJrC8U47ikrE","Trail",void 0);var v=c.ccclass,d=(c.property,c.requireComponent);e("Trail",v("Trail")(g=d(l)(g=function(e){t(c,e);var o=r(c);function c(){var e;i(this,c);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e=o.call.apply(o,[this].concat(r)),n(a(e),"graphics",void 0),e}return s(c,[{key:"start",value:function(){this.graphics=this.node.getComponent(l)}},{key:"begin",value:function(){this.graphics.clear(),this.graphics.moveTo(0,0)}},{key:"finish",value:function(){this.graphics.stroke()}},{key:"pushSegment",value:function(e){var t=new u;this.node.getWorldPosition(t);var r=new u;e.node.getWorldPosition(r);var i=h.subtract(new h,r,t);this.graphics.moveTo(i.x,i.y);var n=new u;e.parentPart.getWorldPosition(n);var a=h.subtract(new h,n,r),s=h.subtract(new h,e.getDestination(),r);h.angle(a,s)>0&&this.graphics.lineTo(h.add(new h,i,s)),this.graphics.lineTo(h.add(new h,i,a))}}]),c}(p))||g)||g);o._RF.pop()}}}));

System.register("chunks:///_virtual/UIApi.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Manager.ts","./Controller.ts","./MapGenerator.ts"],(function(e){"use strict";var t,o,r,n,a,i,l,s,c,u,p,d,h,g,m,f,v,b,C,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inherits,r=e.createSuper,n=e.classCallCheck,a=e.initializerDefineProperty,i=e.assertThisInitialized,l=e.defineProperty,s=e.createClass},function(e){c=e.cclegacy,u=e._decorator,p=e.Node,d=e.find,h=e.Label,g=e.Widget,m=e.Component},function(e){f=e.Manager},function(e){v=e.Controller,b=e.ControllerEvent},function(e){C=e.MapGenerator,y=e.MapGeneratorEvent}],execute:function(){var N,k,S,R,w,D,T,z,A,E,O,_,L,M,P;c._RF.push({},"a575eDZHqVHkos8Q4YBUXna","UIApi",void 0);var U=u.ccclass,G=u.property;function I(e){return"SCORE [ ".concat(e," ]")}function B(e){return"[ ".concat(e," ] ROCKS")}e("UIApi",(N=U("UIApi"),k=G(p),S=G(p),R=G(p),w=G(p),D=G(p),T=G(p),N((E=t((A=function(e){o(c,e);var t=r(c);function c(){var e;n(this,c);for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r)),a(i(e),"scoreNode",E,i(e)),a(i(e),"rocksNode",O,i(e)),a(i(e),"headNode",_,i(e)),a(i(e),"worldNode",L,i(e)),a(i(e),"restart",M,i(e)),a(i(e),"topScores",P,i(e)),l(i(e),"managerNode",void 0),e}return s(c,[{key:"onLoad",value:function(){this.restart.active=!1,this.topScores.active=!1,this.managerNode=d("Manager"),this.headNode.getComponent(v).eventTarget.on(b.STOPPED,this.onGameOver,this),this.headNode.getComponent(v).eventTarget.on(b.SCORE_UPDATED,this.updateScore,this),this.worldNode.getComponent(C).eventTarget.on(y.ROCKS_UPDATED,this.updateRocks,this),this.restart.on("click",this.onRestartClick,this)}},{key:"updateLabel",value:function(e,t,o){e.getComponent(h).string=o(t),e.getComponent(g).updateAlignment()}},{key:"onGameOver",value:function(e){for(var t=this.managerNode.getComponent(f).getLastTopRecords(5),o=0;o<5;++o){var r=this.topScores.getChildByName("_"+(o+1)),n=t[o];if(r&&n){var a=new Date(t[o].timestamp).toTimeString().split(" ")[0],i="SCORE: ".concat(t[o].score," | at ").concat(a);e&&e.timestamp===n.timestamp&&(i="> "+i+" <"),r.getComponent(h).string=i}}this.restart.active=!0,this.topScores.active=!0}},{key:"onRestartClick",value:function(){this.managerNode.getComponent(f).reloadScene()}},{key:"updateRocks",value:function(e){this.updateLabel(this.rocksNode,e,B)}},{key:"updateScore",value:function(e){this.updateLabel(this.scoreNode,e,I)}}]),c}(m)).prototype,"scoreNode",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=t(A.prototype,"rocksNode",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=t(A.prototype,"headNode",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=t(A.prototype,"worldNode",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=t(A.prototype,"restart",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=t(A.prototype,"topScores",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=A))||z));c._RF.pop()}}}));

System.register("chunks:///_virtual/Controller.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Tail.ts","./Trail.ts","./Type.ts","./Fruit.ts","./Manager.ts","./common.ts"],(function(t){"use strict";var e,i,n,o,r,s,a,l,c,h,u,d,p,f,T,v,g,m,y,C,w,E,b,S,k,P,D,R,_,z,A,O,B,I,K,U,F,L,N,q,W;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inherits,n=t.createSuper,o=t.classCallCheck,r=t.initializerDefineProperty,s=t.assertThisInitialized,a=t.defineProperty,l=t.createClass,c=t.createForOfIteratorHelper},function(t){h=t.cclegacy,u=t._decorator,d=t.BoxCollider2D,p=t.Prefab,f=t.Node,T=t.CCInteger,v=t.EventTarget,g=t.Vec2,m=t.Vec3,y=t.find,C=t.input,w=t.Input,E=t.clamp01,b=t.Intersection2D,S=t.instantiate,k=t.KeyCode,P=t.Component},function(t){D=t.Tail},function(t){R=t.Trail},function(t){_=t.Type,z=t.ObjectType},function(t){A=t.Fruit},function(t){O=t.Manager},function(t){B=t.CELL_SIZE,I=t.UP,K=t.DOWN,U=t.EPSILON,F=t.colliderToRect,L=t.getNodeCurrentDirection,N=t.getNodeStartPosition,q=t.LEFT,W=t.RIGHT}],execute:function(){var Y,Z,x,M,Q,j,H,G,V,J,X,$;t("ControllerEvent",void 0),h._RF.push({},"cf630KLGjlEyba08BwzkYmu","Controller",void 0);var tt,et=u.ccclass,it=u.property,nt=u.float,ot=u.integer,rt=u.requireComponent;!function(t){t.FRUIT_REQUEST="fruit-request",t.OBSTACLE_REQUEST="obstacle-request",t.SCORE_UPDATED="score-updated",t.STOPPED="stopped"}(tt||(tt=t("ControllerEvent",{})));t("Controller",(Y=et("Controller"),Z=rt(d),x=it(p),M=it(f),Q=it({type:T,visible:!1}),Y(j=Z((G=e((H=function(t){i(h,t);var e=n(h);function h(){var t;o(this,h);for(var i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return t=e.call.apply(e,[this].concat(n)),r(s(t),"baseSpeed",G,s(t)),a(s(t),"step",B),a(s(t),"speed",0),r(s(t),"startSize",V,s(t)),r(s(t),"tailPrefab",J,s(t)),r(s(t),"tailTrail",X,s(t)),a(s(t),"eventTarget",new v),r(s(t),"score",$,s(t)),a(s(t),"stopped",!0),a(s(t),"trail",void 0),a(s(t),"lastTail",null),a(s(t),"pendingTail",null),a(s(t),"direction",new g(I)),a(s(t),"directionRotationZ",0),a(s(t),"destination",new g(0,0)),a(s(t),"startPosition",new g(0,0)),a(s(t),"movingTime",0),a(s(t),"managerNode",void 0),t}return l(h,[{key:"getDestination",value:function(){return new g(this.destination)}},{key:"getStartPosition",value:function(){return new g(this.startPosition)}},{key:"getCurrentDirection",value:function(){return g.subtract(new g,this.destination,this.node.getWorldPosition(new m)).normalize()}},{key:"onLoad",value:function(){this.managerNode=y("Manager"),C.on(w.EventType.KEY_DOWN,this.onKeyDown,this)}},{key:"onDestroy",value:function(){C.off(w.EventType.KEY_DOWN,this.onKeyDown,this)}},{key:"start",value:function(){this.speed=this.baseSpeed,this.trail=this.tailTrail.getComponent(R);var t=new m;this.node.getWorldPosition(t),this.startPosition.x=t.x,this.startPosition.y=t.y,g.scaleAndAdd(this.destination,this.startPosition,this.direction,this.step),this.movingTime=0,this.startSize>1&&this.growTailByDirection(this.startSize-1,K)}},{key:"isDestinationReached",value:function(){return Math.abs(this.movingTime-1)<U}},{key:"update",value:function(t){var e=this;if(this.stopped)this.lastTail&&this.drawTrail();else{var i=this.movingTime+t*(this.speed/this.step);this.movingTime=E(i),this.isDestinationReached()&&(this.startPosition=new g(this.destination),g.scaleAndAdd(this.destination,this.startPosition,this.direction,this.step),this.movingTime=i>this.movingTime?i-this.movingTime:0,this.lookToDirection(),this.forEachTail((function(t){t.finishRoute()})));var n=new g(0,0);g.lerp(n,this.startPosition,this.destination,this.movingTime),this.node.setWorldPosition(new m(n.x,n.y,0)),this.lastTail&&(this.forEachTail((function(t){t.updatePosition(e.movingTime)})),this.drawTrail()),this.detectCollision()}}},{key:"getTailStack",value:function(){var t=[];if(!this.lastTail)return t;for(var e=this.lastTail.getComponent(D);e;)t.push(e),e=e.parentPart.getComponent(D);return t}},{key:"forEachTail",value:function(t){for(var e,i=this.getTailStack();e=i.pop();)t(e)}},{key:"detectCollision",value:function(){var t,e=c(this.node.parent.children);try{for(e.s();!(t=e.n()).done;){var i=t.value;if(i!==this.node){var n=i.getComponent(d),o=this.node.getComponent(d);n&&b.rectRect(F(o),F(n))&&this.onCollision(i,n)}}}catch(t){e.e(t)}finally{e.f()}}},{key:"onCollision",value:function(t,e){var i=t.getComponent(_);if(null!==i)switch(i.type){case z.FRUIT:var n=t.getComponent(A).points;this.score+=n,this.eventTarget.emit(tt.SCORE_UPDATED,this.score),this.growBy(n),this.setSpeed(this.speed+this.baseSpeed*(t.getComponent(A).speedUp/100)),t.destroy(),this.eventTarget.emit(tt.FRUIT_REQUEST),this.score%5==0&&this.eventTarget.emit(tt.OBSTACLE_REQUEST);break;case z.OBSTACLE:this.setStopped(!0)}}},{key:"drawTrail",value:function(){var t=this.lastTail.getComponent(D);for(this.trail.begin();t;)this.trail.pushSegment(t),t=t.parentPart.getComponent(D);this.trail.finish()}},{key:"setSpeed",value:function(t){this.speed=t}},{key:"setStopped",value:function(t){if(this.stopped=t,t){var e=null;this.score>0&&(e=this.managerNode.getComponent(O).registerScore(this.score)),this.eventTarget.emit(tt.STOPPED,e)}}},{key:"growBy",value:function(t){this.growTailByDirection(t,g.negate(new g,L(this.lastTail?this.lastTail:this.node)))}},{key:"growTailByDirection",value:function(t,e){for(var i=0;i<t;++i){var n=S(this.tailPrefab),o=this.lastTail?this.lastTail:this.node;n.getComponent(D).parentPart=o,n.getComponent(D).head=this.node,n.parent=this.node.parent;var r=N(o),s=g.scaleAndAdd(new g,r,e,this.step),a=r;n.getComponent(D).initRoute(s,a,this.movingTime),this.lastTail=n}}},{key:"onKeyDown",value:function(t){var e=this.getCurrentDirection();switch(t.keyCode){case k.KEY_W:if(g.equals(K,e))return;this.direction=new g(I),this.directionRotationZ=0;break;case k.KEY_A:if(g.equals(W,e))return;this.direction=new g(q),this.directionRotationZ=90;break;case k.KEY_S:if(g.equals(I,e))return;this.direction=new g(K),this.directionRotationZ=180;break;case k.KEY_D:if(g.equals(q,e))return;this.direction=new g(W),this.directionRotationZ=270;break;default:return}this.started||(this.started=!0,this.setStopped(!1))}},{key:"lookToDirection",value:function(){this.node.setRotationFromEuler(0,0,this.directionRotationZ)}}]),h}(P)).prototype,"baseSpeed",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 128}}),V=e(H.prototype,"startSize",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),J=e(H.prototype,"tailPrefab",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(H.prototype,"tailTrail",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=e(H.prototype,"score",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),j=H))||j)||j));h._RF.pop()}}}));

System.register("chunks:///_virtual/Manager.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var r,t,o,n,s,c,a,i,u,l,d;return{setters:[function(e){r=e.inherits,t=e.createSuper,o=e.classCallCheck,n=e.defineProperty,s=e.assertThisInitialized,c=e.createClass},function(e){a=e.cclegacy,i=e._decorator,u=e.game,l=e.director,d=e.Component}],execute:function(){var p;a._RF.push({},"d209dXE971PC5bKgw63BaLO","Manager",void 0);var v=i.ccclass;i.property,e("Manager",v("Manager")(p=function(e){r(i,e);var a=t(i);function i(){var e;o(this,i);for(var r=arguments.length,t=new Array(r),c=0;c<r;c++)t[c]=arguments[c];return e=a.call.apply(a,[this].concat(t)),n(s(e),"scoreRecords",[]),e}return c(i,[{key:"onLoad",value:function(){u.addPersistRootNode(this.node)}},{key:"reloadScene",value:function(){l.loadScene("MainScene"),console.info("top scores",this.getLastTopRecords())}},{key:"registerScore",value:function(e){var r={timestamp:Date.now(),score:e};return this.scoreRecords.push(r),r}},{key:"getLastTopRecords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return this.scoreRecords.sort((function(e,r){return r.score-e.score})).slice(0,e)}}]),i}(d))||p);a._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./FollowCamera.ts","./Tail.ts","./Trail.ts","./Type.ts","./Fruit.ts","./Manager.ts","./Controller.ts","./common.ts","./Grid.ts","./Obstacle.ts","./MapGenerator.ts","./UIApi.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});